<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.schedule.app.repository.CommonScheduleSearchMapper">
    <!-- readDefaultScheduleRecord -->
    <select id="readDefaultScheduleRecord" resultType="com.schedule.app.record.output.DefaultScheduleOutputRecord">
        SELECT
            NULL AS userId,
            ds.id,
            ds.start_time AS startTime,
            ds.end_time AS endTime,
            ds.start_date AS startDate,
            ds.end_date AS endDate,
            st.work_type_name AS worktypeName,
            st.work_type_color AS worktypeColor
        FROM
            common_default_schedule AS ds
        JOIN
            schedule_type AS st ON ds.work_type_id = st.id
        <where>
            <if test="from != null">
                AND ds.end_date &gt;= #{from}
            </if>
            <if test="to != null">
                AND ds.start_date &lt;= #{to}
            </if>
        </where>
    </select>

    <!-- readRegularScheduleRecord -->
    <select id="readRegularScheduleRecord" resultType="com.schedule.app.record.output.RegularScheduleOutputRecord">
        SELECT
            NULL AS userId,
            rs.id,
            rs.start_time AS startTime,
            rs.end_time AS endTime,
            rs.start_date AS startDate,
            rs.end_date AS endDate,
            rs.days_of_week AS daysOfWeek,
            rs.interval_weeks AS intervalWeeks,
            st.work_type_name AS worktypeName,
            st.work_type_color AS worktypeColor
        FROM
            common_regular_schedule AS rs
        JOIN
            schedule_type AS st ON rs.work_type_id = st.id
        <where>
            <if test="from != null">
                AND rs.end_date &gt;= #{from}
            </if>
            <if test="to != null">
                AND rs.start_date &lt;= #{to}
            </if>
        </where>
    </select>

    <!-- readIrregularScheduleRecord -->
    <select id="readIrregularScheduleRecord" resultType="com.schedule.app.record.output.IrregularScheduleOutputRecord">
        SELECT
            NULL AS userId,
            irs.id,
            irs.start_time AS startTime,
            irs.end_time AS endTime,
            irs.date,
            st.work_type_name AS worktypeName,
            st.work_type_color AS worktypeColor
        FROM
            common_irregular_schedule AS irs
        JOIN
            schedule_type AS st ON irs.work_type_id = st.id
        <where>
            <if test="from != null">
                AND irs.date &gt;= #{from}
            </if>
            <if test="to != null">
                AND irs.date &lt;= #{to}
            </if>
        </where>
    </select>
</mapper>